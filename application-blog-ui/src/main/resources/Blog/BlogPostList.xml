<?xml version="1.1" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc version="1.4" reference="Blog.BlogPostList" locale="">
  <web>Blog</web>
  <name>BlogPostList</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1489395686000</creationDate>
  <parent>Blog.WebHome</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1749827422000</date>
  <contentUpdateDate>1749827422000</contentUpdateDate>
  <version>1.1</version>
  <title>BlogPostList</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>true</hidden>
  <content/>
  <object>
    <name>Blog.BlogPostList</name>
    <number>0</number>
    <className>XWiki.WikiMacroClass</className>
    <guid>b52a7973-2961-4277-882a-b1150721d9db</guid>
    <class>
      <name>XWiki.WikiMacroClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <async_cached>
        <defaultValue>0</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType/>
        <name>async_cached</name>
        <number>12</number>
        <prettyName>Cached</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </async_cached>
      <async_context>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>1</multiSelect>
        <name>async_context</name>
        <number>13</number>
        <prettyName>Context elements</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>, </separator>
        <separators>|, </separators>
        <size>5</size>
        <unmodifiable>0</unmodifiable>
        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.parameters=Request parameters|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </async_context>
      <async_enabled>
        <defaultValue>0</defaultValue>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType/>
        <name>async_enabled</name>
        <number>11</number>
        <prettyName>Asynchronous rendering</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </async_enabled>
      <code>
        <disabled>0</disabled>
        <editor>Text</editor>
        <name>code</name>
        <number>10</number>
        <prettyName>Macro code</prettyName>
        <rows>20</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <contentDescription>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>contentDescription</name>
        <number>9</number>
        <prettyName>Content description (Not applicable for "No content" type)</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </contentDescription>
      <contentJavaType>
        <cache>0</cache>
        <defaultValue>Unknown</defaultValue>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <freeText>allowed</freeText>
        <largeStorage>1</largeStorage>
        <multiSelect>0</multiSelect>
        <name>contentJavaType</name>
        <number>8</number>
        <picker>1</picker>
        <prettyName>Macro content type</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>|</separator>
        <separators>|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>Unknown|Wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </contentJavaType>
      <contentType>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>contentType</name>
        <number>7</number>
        <prettyName>Macro content availability</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>|</separator>
        <separators>|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>Optional|Mandatory|No content</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </contentType>
      <defaultCategory>
        <disabled>0</disabled>
        <name>defaultCategory</name>
        <number>4</number>
        <prettyName>Default category</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultCategory>
      <description>
        <contenttype>PureText</contenttype>
        <disabled>0</disabled>
        <editor>PureText</editor>
        <name>description</name>
        <number>3</number>
        <prettyName>Macro description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <id>
        <disabled>0</disabled>
        <name>id</name>
        <number>1</number>
        <prettyName>Macro id</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </id>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>2</number>
        <prettyName>Macro name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <supportsInlineMode>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>supportsInlineMode</name>
        <number>5</number>
        <prettyName>Supports inline mode</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </supportsInlineMode>
      <visibility>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <freeText>forbidden</freeText>
        <largeStorage>0</largeStorage>
        <multiSelect>0</multiSelect>
        <name>visibility</name>
        <number>6</number>
        <prettyName>Macro visibility</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator>|</separator>
        <separators>|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>Current User|Current Wiki|Global</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </visibility>
    </class>
    <property>
      <async_cached/>
    </property>
    <property>
      <async_context/>
    </property>
    <property>
      <async_enabled/>
    </property>
    <property>
      <code>{{include reference='Blog.CategoriesCode' /}}

{{include reference='Blog.BlogPostLayoutMacros' /}}

{{velocity output='no'}}
#set ($blogDescriptorParam = $xcontext.macro.params.blog)
#set ($categoryParam = $xcontext.macro.params.category)
#set ($fromDateParam = $xcontext.macro.params.fromDate)
#set ($toDateParam = $xcontext.macro.params.toDate)
#set ($publishedParam = $xcontext.macro.params.published)
#set ($hiddenParam = $xcontext.macro.params.hidden)
#set ($limitParam = $xcontext.macro.params.limit)
#set ($layoutParam = $xcontext.macro.params.layout)
#set ($paginated = "$!xcontext.macro.params.paginated" != 'no')
#set ($layoutAdditionalParams = $xcontext.macro.params.layoutParams)
## Passing the blog posts list parameters to the layout macro
#foreach($p in $xcontext.macro.params.getParameterNames())
  #if ($p == 'blog' &amp;&amp; "$!blogDescriptorParam" != '')
    #set ($v = $blogDescriptorParam)
    #set ($layoutAdditionalParams = "$!{layoutAdditionalParams}|list-${p}=${v}")
  #elseif($p != 'layoutParams' &amp;&amp; "$!xcontext.macro.params.get($p)" != '')
    #set ($v = $xcontext.macro.params.get($p))
    #set ($layoutAdditionalParams = "$!{layoutAdditionalParams}|list-${p}=${v}")
  #end
#end
## If the 'layoutParams' parameter is empty check if there are layout parameters set at Blog level.
#if("$!blogDescriptorParam" != '' &amp;&amp; "$!xcontext.macro.params.layoutParams" == '')
  #set ($blogDoc = $xwiki.getDocument($blogDescriptorParam))
  #set ($blogObj = $blogDoc.getObject($blogClassname))
  #set ($blogLayoutParams = $blogObj.getProperty('postsLayoutParameters').value)
  #if ("$!blogLayoutParams" != '')
    #set ($layoutAdditionalParams = "$!{layoutAdditionalParams}|${blogLayoutParams}")
  #end
#end
#if ("$!layoutAdditionalParams" != '' &amp;&amp; $layoutAdditionalParams.startsWith('|'))
  #set ($layoutAdditionalParams = $layoutAdditionalParams.replaceFirst('\|', ''))
#end
#set ($blogPostLayoutPrefix = 'blogPostLayout')
#set ($isValidBlog = false)
#set ($isAggregatorBlog = false)
#set ($blogCategoriesLocation = $defaultBlogSpace)
#set ($blogPostsLocation = $defaultBlogSpace)
#set ($results = [])

#getAllBlogPostsQuery($hql)
#set ($queryParams = {})
#set ($whereQuery = "")

## blog descriptor parameter
#if ("$!blogDescriptorParam" != '')
  ## Get information from the blog descriptor
  #set ($blogDescriptorDoc = $xwiki.getDocument($blogDescriptorParam))
  #set ($blogDescriptorObj = $blogDescriptorDoc.getObject($blogClassname))
  #if ("$!blogDescriptorObj" != '')
    #set ($isValidBlog = true)
    ## For backwards compatibility the default blog (under 'Blog' space) is considered as an aggregator blog
    #if ($blogDescriptorDoc.space == $defaultBlogSpace)
      #set ($isAggregatorBlog = true)
    #end
    #if ("$!blogDescriptorObj.getProperty('categoriesLocation').value" != '')
      #set ($blogCategoriesLocation = $blogDescriptorObj.getProperty('categoriesLocation').value)
    #end
    #if ("$!blogDescriptorObj.getProperty('postsLocation').value" != '')
      #set ($blogPostsLocation = $blogDescriptorObj.getProperty('postsLocation').value)
    #elseif($blogDescriptorDoc.space != $defaultBlogSpace)
      #set ($blogPostsLocation = $blogDescriptorDoc.space)
    #end
  #end
  #set($sanitizedCategoriesLocation = $blogCategoriesLocation.replaceAll('([%_!])', '!$1').concat('.%'))
  #if ($isAggregatorBlog)
    #getCategoryAllBlogPostsQuery($hql)
    #set ($discard = $queryParams.put('catList', $sanitizedCategoriesLocation))
    #set ($discard = $queryParams.put('space', $blogPostsLocation))
    #set ($whereQuery = " and (doc.space = :space or catList like :catList escape '!')")
  #else
    #set ($discard = $queryParams.put('space', $blogPostsLocation))
    #set ($whereQuery = " and doc.space =:space")
  #end
#end

#if ("$!blogDescriptorParam" != '' &amp;&amp; !$isValidBlog)
  #set ($XDOMList = [])
  #set ($toParse = "{{error}}${services.localization.render('blog.blogpostlist.descriptor_not_found', [$blogDescriptorParam])}{{/error}}")
  #set ($xdom = $services.rendering.parse($toParse, $xwiki.getCurrentContentSyntaxId()).getChildren())
  #set ($discard = $XDOMList.addAll($xdom))
  #set($xcontext.macro.result = $XDOMList)
#else
  ## category parameter
  #if("$!categoryParam" != '')
    #getCategoryAllBlogPostsQuery($hql)
    ## Check if it is a category or space
    #set ($isCategoriesSpace = true)
    #set ($categoryDoc = $xwiki.getDocument($categoryParam))
    #if (!$categoryDoc.isNew())
      #set ($categoryObj = $categoryDoc.getObject('Blog.CategoryClass'))
      #if ("$!categoryObj" != '')
        #set ($isCategoriesSpace = false)
      #end
    #end
    #if ($isCategoriesSpace)
      ## Exclude uncategorized posts
      #set ($excludedCategory = "${categoryParam}.WebHome")
      #if ($categoryParam == $defaultBlogSpace)
        #set ($excludedCategory = "${categoryParam}.Categories.WebHome")
      #end
      #set($sanitizedCategoryParam = $categoryParam.replaceAll('([%_!])', '!$1').concat('.%'))
      #set ($whereQuery = "${whereQuery} and catList&lt;&gt;:excludedCategory and catList like :category escape '!'")
      #set ($discard = $queryParams.put('category', $sanitizedCategoryParam))
      #set ($discard = $queryParams.put('excludedCategory', $excludedCategory))
    #else
      ## Get all posts of the category and its sub categories
      #getCategoriesHierarchy ($categoryDoc.space $catTree)
      #set ($subcategories = [])
      #getSubcategories ($catTree $categoryParam $subcategories)
      #set ($whereQuery = "${whereQuery} and (catList=:category")
      #set ($discard = $queryParams.put('category', $categoryParam))
      #foreach($subCategory in $subcategories)
        #set ($whereQuery = "${whereQuery} or catList=:category${foreach.count}")
        #set ($discard = $queryParams.put("category${foreach.count}", $subCategory))
      #end
      #set ($whereQuery = "${whereQuery} )")
    #end
  #end

  ## fromDate parameter
  #if ("$!fromDateParam" != '' &amp;&amp; "$!datetool.toDate('yyyy-M-d', $fromDateParam)" != '')
    #set ($whereQuery = "${whereQuery} and publishDate.value&gt;=:fromDate")
    #set ($discard = $queryParams.put('fromDate', $datetool.toDate("yyyy-M-d", $fromDateParam)))
  #end

  ## toDate parameter
  #if ("$!toDateParam" != '' &amp;&amp; "$!datetool.toDate('yyyy-M-d', $toDateParam)" != '')
    #set ($cal = $datetool.getCalendar())
    #set ($discard = $cal.setTime($datetool.toDate("yyyy-M-d", $toDateParam)))
    #set ($discard = $cal.add(5, 1)) ## toDate = toDate + 1 day
    #set ($whereQuery = "${whereQuery} and publishDate.value&lt;:toDate")
    #set ($discard = $queryParams.put('toDate', $datetool.toDate("yyyy-M-d", $cal.getTime())))
  #end

  #if ("$!publishedParam" != '')
    #if ("$!publishedParam" == 'no')
      #set ($whereQuery = "${whereQuery} and isPublished.value=0")
    #elseif("$!publishedParam" == 'yes')
      #set ($whereQuery = "${whereQuery} and isPublished.value=1")
    #end
  #end

  #if ("$!hiddenParam" != '')
    #if ("$!hiddenParam" == 'yes')
      #set ($whereQuery = "${whereQuery} and hidden.value=1")
    #elseif("$!hiddenParam" == 'no')
      #set ($whereQuery = "${whereQuery} and hidden.value=0")
    #end
  #end

  #set ($hql = "${hql} ${whereQuery}")

  ## Exclude pinned posts
  ## Pinned posts are a list of blog posts that are saved in a Blog.PinnedPostsClass object attached to the descriptor of the blog
  ## The pinned posts are displayed in a different way on the blog post layout compared to the other blog posts, FTM the pinned posts are supported on the 'cards' blog post layout
  ## the pinned posts are displayed only if the blog post layout parameter 'forceDisplayPinnedPosts' is equal to 'true'
  #set ($pinnedPosts = [])
  #extractLayoutParametersFromString($layoutAdditionalParams $layoutParamsMap)
  #if ("$!layoutParamsMap.get('forceDisplayPinnedPosts')" == 'true' &amp;&amp; "$!blogDescriptorParam" != '')
    #set ($pinnedPostsSourceDoc = $xwiki.getDocument($blogDescriptorParam))
  #end
  #if ("$!pinnedPostsSourceDoc" != '')
    #set ($pinnedPostsObj = $pinnedPostsSourceDoc.getObject('Blog.PinnedPostsClass'))
    #if ("$!pinnedPostsObj" != '')
      #set ($pinnedPosts = $pinnedPostsObj.getProperty('posts').value)
    #end
  #end
  #if ($pinnedPosts.size() &gt; 0)
    #set ($hql = "${hql} and doc.fullName not in :pinnedPosts")
    #set ($discard = $queryParams.put('pinnedPosts', $pinnedPosts))
  #end
  ###

  ## Ordering
  #set ($hql = "${hql} order by publishDate.value desc")
  #set($query = $services.query.hql($hql))
  #set($countQuery = $services.query.hql($hql))
  #bindQueryParameters($query $queryParams)
  #bindQueryParameters($countQuery $queryParams)

  #if ($paginated)
    #if ("$!limitParam" == '')
      #if ($isValidBlog) ## Get the blog itemsPerPage parameter
        #getBlogProperty($blogDescriptorDoc 'itemsPerPage' '10' $limitParam)
      #else
        #set ($limitParam = 10)
      #end
    #end
    #set ($totalPosts = $countQuery.addFilter("unique").count())
    ## This macro is defined in the default macros.vm library. It also sets $itemsPerPage and $startAt.
    #set ($itemsPerPage = $numbertool.toNumber($limitParam).intValue())
    #preparePagedViewParams($totalPosts $itemsPerPage)
    #set ($query = $query.setOffset($startAt))
  #end
  #if ("$!limitParam" != '')
    #set ($query = $query.setLimit($numbertool.toNumber($limitParam).intValue()))
  #end

  #if ("$!layoutParam" != '')
    #set ($blogPostLayoutMacro = "${blogPostLayoutPrefix}${layoutParam.substring(0, 1).toUpperCase()}${layoutParam.substring(1)}")
    #set ($blogPostLayoutMacro = $blogPostLayoutMacro.replaceAll('~', '~~').replaceAll('"', '~"'))
  #end

  #set ($results = [])

  #if("$!limitParam" == '' || $numbertool.toNumber($limitParam).intValue() &gt; 0)
    #set ($results = $query.addFilter("unique").execute())
  #end

  ## If all the posts are pinned nothing will be returned by the query because pinned posts are excluded
  ## Note, that the pinned posts are stored in an object attached to the blog descriptor.
  ## The display of pinned posts is managed inside the blog post layout macros.
  ## so, before the display of the first post, the pinned posts are extracted from the blog descriptor and displayed in a custom way (big blocks, ...).
  ## In order to display the pinned posts even if the query don't return results we return the pinned posts as results.

  #if ($pinnedPosts.size() &gt; 0 &amp;&amp; $results.size() == 0)
    #set ($results = $pinnedPosts)
  #end

  #set ($layoutAdditionalParams = "$!{layoutAdditionalParams}|list-results-count=${results.size()}")
  #set ($layoutAdditionalParams = $layoutAdditionalParams.replaceAll('~', '~~').replaceAll('"', '~"'))
  #set ($XDOMList = [])
  #set ($previousPostReference = '')
  #foreach($result in $results)
    #if ($services.security.authorization.hasAccess('view', $result))
      #set ($layoutAdditionalParams = "${layoutAdditionalParams}|postIndex=${foreach.index}|previousPostReference=$!{previousPostReference}")
      #set ($escapedPostReference = $result.replaceAll('~', '~~').replaceAll('"', '~"'))
      #set ($toParse = "{{${blogPostLayoutMacro} reference=${escapetool.getQuote()}${escapedPostReference}${escapetool.getQuote()} params=${escapetool.getQuote()}$!layoutAdditionalParams${escapetool.getQuote()}/}}")
      #set ($xdom = $services.rendering.parse($toParse, $xwiki.getCurrentContentSyntaxId()).getChildren())
      #set ($discard = $XDOMList.addAll($xdom))
      #set ($previousPostReference = $escapedPostReference)
    #end
  #end
  ## Pagination
  #if ($paginated)
    #set ($xdom = $services.rendering.parse("{{html wiki='true'}}#displayNavigationLinks($NULL){{/html}}", $xwiki.getCurrentContentSyntaxId()).getChildren())
    #set ($discard = $XDOMList.addAll($xdom))
  #end
  #set($xcontext.macro.result = $XDOMList)
#end
{{/velocity}}</code>
    </property>
    <property>
      <contentDescription/>
    </property>
    <property>
      <contentJavaType/>
    </property>
    <property>
      <contentType>No content</contentType>
    </property>
    <property>
      <defaultCategory/>
    </property>
    <property>
      <description>The BlogPostMacro is used to search and display blog posts based on some parameters, the results can be displayed using customizable templates.</description>
    </property>
    <property>
      <id>blogpostlist</id>
    </property>
    <property>
      <name>Blog post list</name>
    </property>
    <property>
      <supportsInlineMode/>
    </property>
    <property>
      <visibility>Current Wiki</visibility>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>0</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>21bf9296-da34-4a5b-ab1f-a63591103b6d</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>The  descriptor document of a given blog (It should contain a document with a Blog.BlogClass object)</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>blog</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>1</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>c5c9a71b-8a98-423f-996d-414eb12b560c</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>Either a given category or a category space (not mandatory, at least blog or category mandatory)</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>category</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>2</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>3b2fb076-05ba-471c-9206-bf1c8a3854c1</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>limit posts to posts published starting from a given date. The format of the parameter is yyyy-mm-dd.</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>fromDate</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>3</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>7cd0b986-ffc6-4f31-9865-56d3d04992a1</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>limit posts to posts published before a given date. The format of the parameter is yyyy-mm-dd.</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>toDate</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>4</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>c8a71e74-3818-45da-bba0-259b0570b962</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>Limit results to published posts.

Possible values: yes, no, all.

Default value: yes.</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>published</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>5</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>914ba220-4a24-44bc-abd5-ae1e5b5c6525</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>Limit results to hidden posts.

Possible values: no, yes, all.

Default value: no.</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>hidden</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>6</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>3fc47d9a-d32d-40f4-901a-4f46765dcae5</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>Number of posts to display</description>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>limit</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>7</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>28bd8dec-fe06-486c-9d2d-06697ec062df</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue>link</defaultValue>
    </property>
    <property>
      <description>The name of the macro that will be used to display the results. The default layout is the 'link' (blogPostLayoutLink macro) used to display posts as links.

The layout macro has a parameter: 'reference' that contains the document full name of the blog posts to display.

The naming convention for the layout macros is: "BlogPostLayout${macroName}"</description>
    </property>
    <property>
      <mandatory>0</mandatory>
    </property>
    <property>
      <name>layout</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>8</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>f38c0b26-e37a-4f1b-b421-3cb8b232140f</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue/>
    </property>
    <property>
      <description>Additional parameters of the blog post layout</description>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>layoutParams</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
  <object>
    <name>Blog.BlogPostList</name>
    <number>9</number>
    <className>XWiki.WikiMacroParameterClass</className>
    <guid>926468bd-6f1d-421e-8375-28b7feb31c19</guid>
    <class>
      <name>XWiki.WikiMacroParameterClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <defaultValue>
        <disabled>0</disabled>
        <name>defaultValue</name>
        <number>4</number>
        <prettyName>Parameter default value</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </defaultValue>
      <description>
        <disabled>0</disabled>
        <name>description</name>
        <number>2</number>
        <prettyName>Parameter description</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </description>
      <mandatory>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>mandatory</name>
        <number>3</number>
        <prettyName>Parameter mandatory</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </mandatory>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Parameter name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <type>
        <disabled>0</disabled>
        <name>type</name>
        <number>5</number>
        <prettyName>Parameter type</prettyName>
        <size>60</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </type>
    </class>
    <property>
      <defaultValue>yes</defaultValue>
    </property>
    <property>
      <description>Used to enble/disable the pagination of the the blogPostList macro results</description>
    </property>
    <property>
      <mandatory/>
    </property>
    <property>
      <name>paginated</name>
    </property>
    <property>
      <type/>
    </property>
  </object>
</xwikidoc>
